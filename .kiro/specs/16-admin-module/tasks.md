# 后台管理模块 - 任务清单

## 前置条件

- [ ] 确认前端核心基础设施模块（12）已完成
- [ ] 确认后端管理API可用

## Phase 1: API和工具 (优先级: P0)

### 1.1 API集成
- [ ] 创建 `lib/api/endpoints/admin.ts`
- [ ] auditEquipment - 审核设备
- [ ] getPendingList - 待审核列表
- [ ] getUserList - 用户列表
- [ ] updateUserStatus - 封禁/解封用户
- [ ] getStats - 数据统计
- [ ] getReportList - 举报列表
- [ ] handleReport - 处理举报

### 1.2 工具函数
- [ ] getRiskLevel - 风险等级判断
- [ ] exportToExcel - 导出Excel
- [ ] exportToCSV - 导出CSV

## Phase 2: 布局组件 (优先级: P0)

### 2.1 后台布局
- [ ] 创建 `app/admin/layout.tsx`
- [ ] 实现布局结构
- [ ] 权限验证
- [ ] 未授权跳转

### 2.2 侧边栏
- [ ] 创建 `components/admin/AdminSidebar.tsx`
- [ ] Logo显示
- [ ] 菜单项
- [ ] 当前路由高亮
- [ ] 徽章显示（待处理数量）

### 2.3 顶部栏
- [ ] 创建 `components/admin/AdminHeader.tsx`
- [ ] 面包屑导航
- [ ] 管理员信息
- [ ] 退出登录按钮

## Phase 3: 基础组件 (优先级: P0)

### 3.1 统计卡片
- [ ] 创建 `components/admin/StatsCard.tsx`
- [ ] 标题
- [ ] 数值
- [ ] 趋势
- [ ] 图标
- [ ] 颜色主题

### 3.2 审核列表
- [ ] 创建 `components/admin/AuditList.tsx`
- [ ] 设备卡片
- [ ] 复选框
- [ ] 风险评分显示
- [ ] 用户信息
- [ ] 操作按钮

### 3.3 审核详情Modal
- [ ] 创建 `components/admin/AuditModal.tsx`
- [ ] 设备完整信息
- [ ] 用户信息
- [ ] 历史违规记录
- [ ] 风险评分详情
- [ ] 审核操作

### 3.4 用户列表
- [ ] 创建 `components/admin/UserList.tsx`
- [ ] 用户表格
- [ ] 用户信息
- [ ] 状态显示
- [ ] 操作按钮

### 3.5 用户详情Modal
- [ ] 创建 `components/admin/UserModal.tsx`
- [ ] 基本信息
- [ ] 认证信息
- [ ] 账户信息
- [ ] 发布记录
- [ ] 违规记录

### 3.6 举报列表
- [ ] 创建 `components/admin/ReportList.tsx`
- [ ] 举报卡片
- [ ] 举报信息
- [ ] 被举报对象
- [ ] 操作按钮

### 3.7 举报详情Modal
- [ ] 创建 `components/admin/ReportModal.tsx`
- [ ] 举报信息
- [ ] 被举报对象详情
- [ ] 举报人信息
- [ ] 处理操作

### 3.8 图表组件
- [ ] 创建 `components/admin/Charts.tsx`
- [ ] LineChart - 折线图
- [ ] BarChart - 柱状图
- [ ] PieChart - 饼图

## Phase 4: 数据概览页面 (优先级: P0)

### 4.1 页面创建
- [ ] 创建 `app/admin/page.tsx`
- [ ] 实现页面布局
- [ ] 添加标题

### 4.2 数据加载
- [ ] 调用adminApi.getStats
- [ ] 加载状态
- [ ] 错误处理

### 4.3 统计卡片
- [ ] 用户总数卡片
- [ ] 设备总数卡片
- [ ] 待审核卡片
- [ ] 订单金额卡片

### 4.4 图表展示
- [ ] 用户增长趋势图
- [ ] 设备发布趋势图
- [ ] 订单金额趋势图
- [ ] 设备分类分布图

### 4.5 快捷入口
- [ ] 待审核设备按钮
- [ ] 待处理举报按钮

## Phase 5: 设备审核页面 (优先级: P0)

### 5.1 页面创建
- [ ] 创建 `app/admin/audit/page.tsx`
- [ ] 实现页面布局
- [ ] 添加标题和批量操作按钮

### 5.2 风险评分筛选
- [ ] 实现Tabs组件
- [ ] 全部/高风险/中风险/低风险
- [ ] 切换时重新加载数据

### 5.3 审核列表
- [ ] 集成AuditList组件
- [ ] 调用adminApi.getPendingList
- [ ] 加载状态
- [ ] 空状态

### 5.4 审核操作
- [ ] 实现handleAudit
- [ ] 通过审核
- [ ] 拒绝审核（填写原因）
- [ ] 操作成功后刷新列表

### 5.5 批量审核
- [ ] 复选框选择
- [ ] 批量通过
- [ ] 批量拒绝
- [ ] 操作成功后刷新列表

### 5.6 分页功能
- [ ] 集成Pagination组件
- [ ] 每页20条
- [ ] 页码切换

## Phase 6: 用户管理页面 (优先级: P0)

### 6.1 页面创建
- [ ] 创建 `app/admin/users/page.tsx`
- [ ] 实现页面布局
- [ ] 添加标题

### 6.2 搜索筛选
- [ ] 关键词搜索输入框
- [ ] 等级筛选下拉框
- [ ] 状态筛选下拉框
- [ ] 筛选条件状态管理

### 6.3 用户列表
- [ ] 集成UserList组件
- [ ] 调用adminApi.getUserList
- [ ] 加载状态
- [ ] 空状态

### 6.4 封禁操作
- [ ] 实现handleBan
- [ ] 填写封禁原因
- [ ] 填写封禁时长
- [ ] 调用adminApi.updateUserStatus
- [ ] 操作成功后刷新列表

### 6.5 解封操作
- [ ] 实现handleUnban
- [ ] 调用adminApi.updateUserStatus
- [ ] 操作成功后刷新列表

### 6.6 分页功能
- [ ] 集成Pagination组件
- [ ] 每页20条
- [ ] 页码切换

## Phase 7: 举报管理页面 (优先级: P1)

### 7.1 页面创建
- [ ] 创建 `app/admin/reports/page.tsx`
- [ ] 实现页面布局
- [ ] 添加标题

### 7.2 状态筛选
- [ ] 实现Tabs组件
- [ ] 全部/待处理/已处理/已驳回
- [ ] 切换时重新加载数据

### 7.3 举报列表
- [ ] 集成ReportList组件
- [ ] 调用adminApi.getReportList
- [ ] 加载状态
- [ ] 空状态

### 7.4 处理举报
- [ ] 实现handleReport
- [ ] 举报成立
- [ ] 举报不成立
- [ ] 填写处理结果
- [ ] 操作成功后刷新列表

### 7.5 分页功能
- [ ] 集成Pagination组件
- [ ] 每页20条
- [ ] 页码切换

## Phase 8: 数据统计页面 (优先级: P1)

### 8.1 页面创建
- [ ] 创建 `app/admin/stats/page.tsx`
- [ ] 实现页面布局
- [ ] 添加标题和导出按钮

### 8.2 时间筛选
- [ ] 实现DateRangePicker
- [ ] 今日/本周/本月/自定义
- [ ] 筛选条件状态管理

### 8.3 统计卡片
- [ ] 用户统计卡片
- [ ] 设备统计卡片
- [ ] 交易统计卡片
- [ ] 审核统计卡片

### 8.4 数据加载
- [ ] 调用adminApi.getStats
- [ ] 传递时间范围
- [ ] 加载状态
- [ ] 错误处理

### 8.5 数据导出
- [ ] 实现handleExport
- [ ] 导出Excel
- [ ] 导出CSV

## Phase 9: 图表集成 (优先级: P1)

### 9.1 安装依赖
- [ ] 安装recharts
- [ ] 安装@types/recharts

### 9.2 折线图
- [ ] 实现LineChart组件
- [ ] 用户增长趋势
- [ ] 设备发布趋势

### 9.3 柱状图
- [ ] 实现BarChart组件
- [ ] 订单金额趋势

### 9.4 饼图
- [ ] 实现PieChart组件
- [ ] 设备分类分布
- [ ] 用户等级分布

## Phase 10: 测试和优化 (优先级: P1)

### 10.1 功能测试
- [ ] 测试数据概览
- [ ] 测试设备审核
- [ ] 测试用户管理
- [ ] 测试举报管理
- [ ] 测试数据统计
- [ ] 测试权限验证

### 10.2 边界测试
- [ ] 测试非管理员访问
- [ ] 测试批量操作
- [ ] 测试数据导出
- [ ] 测试网络错误

### 10.3 性能优化
- [ ] 列表分页优化
- [ ] 图表渲染优化
- [ ] 图片懒加载
- [ ] 数据缓存

### 10.4 用户体验优化
- [ ] 加载状态优化
- [ ] 错误提示优化
- [ ] 操作确认优化
- [ ] 响应式布局

## 依赖安装

```bash
cd frontend
npm install recharts
npm install xlsx
npm install @types/recharts -D
```

## 验收标准

### Phase 1-2 验收（基础）
- [ ] API调用正常
- [ ] 布局组件正常显示
- [ ] 权限验证正确

### Phase 3 验收（组件）
- [ ] 所有组件正常显示
- [ ] 交互功能正常
- [ ] Modal正常打开关闭

### Phase 4 验收（数据概览）
- [ ] 页面正常显示
- [ ] 统计数据正确
- [ ] 图表正常渲染
- [ ] 快捷入口正常

### Phase 5 验收（设备审核）
- [ ] 审核列表正常显示
- [ ] 风险评分筛选正常
- [ ] 审核操作成功
- [ ] 批量审核正常
- [ ] 分页功能正常

### Phase 6 验收（用户管理）
- [ ] 用户列表正常显示
- [ ] 搜索筛选正常
- [ ] 封禁操作成功
- [ ] 解封操作成功
- [ ] 分页功能正常

### Phase 7 验收（举报管理）
- [ ] 举报列表正常显示
- [ ] 状态筛选正常
- [ ] 处理举报成功
- [ ] 分页功能正常

### Phase 8 验收（数据统计）
- [ ] 统计页面正常显示
- [ ] 时间筛选正常
- [ ] 统计数据正确
- [ ] 数据导出成功

### Phase 9 验收（图表）
- [ ] 所有图表正常渲染
- [ ] 图表数据正确
- [ ] 图表交互正常

### Phase 10 验收（优化）
- [ ] 所有功能测试通过
- [ ] 性能满足要求
- [ ] 用户体验良好

## 预计工时

- Phase 1: 2小时（API和工具）
- Phase 2: 3小时（布局组件）
- Phase 3: 6小时（基础组件）
- Phase 4: 3小时（数据概览）
- Phase 5: 4小时（设备审核）
- Phase 6: 4小时（用户管理）
- Phase 7: 3小时（举报管理）
- Phase 8: 3小时（数据统计）
- Phase 9: 4小时（图表集成）
- Phase 10: 3小时（测试优化）

**总计: 35小时（约4-5个工作日）**

## 开发顺序建议

1. **第一天**：Phase 1-3（基础+布局+组件）
2. **第二天**：Phase 4-5（概览+审核）
3. **第三天**：Phase 6-7（用户+举报）
4. **第四天**：Phase 8-9（统计+图表）
5. **第五天**：Phase 10（测试优化）
