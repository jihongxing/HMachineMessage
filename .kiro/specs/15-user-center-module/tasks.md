# 用户中心模块 - 任务清单

## 前置条件

- [ ] 确认前端核心基础设施模块（12）已完成
- [ ] 确认图片上传组件（13）已完成
- [ ] 确认后端用户API可用

## Phase 1: 工具函数和类型 (优先级: P0)

### 1.1 工具函数
- [ ] 创建 `lib/utils/user.ts`
- [ ] getUserLevelText - 等级文本
- [ ] getPasswordStrength - 密码强度
- [ ] isValidIdCard - 身份证验证
- [ ] maskPhone - 手机号脱敏
- [ ] maskIdCard - 身份证脱敏

### 1.2 API集成
- [ ] 创建 `lib/api/endpoints/user.ts`
- [ ] getProfile - 获取个人信息
- [ ] updateProfile - 更新个人信息
- [ ] changePassword - 修改密码
- [ ] verifyRealName - 实名认证
- [ ] verifyCompany - 企业认证

## Phase 2: 基础组件 (优先级: P0)

### 2.1 用户信息卡片
- [ ] 创建 `components/profile/UserInfo.tsx`
- [ ] 头像显示
- [ ] 昵称显示
- [ ] 手机号显示（脱敏）
- [ ] 等级徽章
- [ ] 认证徽章
- [ ] 编辑按钮

### 2.2 账户信息卡片
- [ ] 创建 `components/profile/AccountInfo.tsx`
- [ ] 余额显示
- [ ] 发布数量
- [ ] 通过数量
- [ ] 违规数量
- [ ] 充值按钮

### 2.3 用户等级组件
- [ ] 创建 `components/profile/UserLevel.tsx`
- [ ] 等级图标
- [ ] 等级名称
- [ ] 等级权益说明
- [ ] 升级条件
- [ ] 升级进度

### 2.4 认证状态组件
- [ ] 创建 `components/profile/VerifyStatus.tsx`
- [ ] 未认证状态
- [ ] 实名认证状态
- [ ] 企业认证状态
- [ ] 去认证按钮

### 2.5 快捷入口组件
- [ ] 创建 `components/profile/QuickLinks.tsx`
- [ ] 我的设备
- [ ] 我的订单
- [ ] 我的收藏
- [ ] 浏览历史
- [ ] 充值
- [ ] 消费记录
- [ ] 修改密码
- [ ] 实名认证
- [ ] 数量徽章显示

### 2.6 余额卡片
- [ ] 创建 `components/profile/BalanceCard.tsx`
- [ ] 余额显示
- [ ] 充值按钮
- [ ] 消费记录按钮

### 2.7 交易记录列表
- [ ] 创建 `components/profile/TransactionList.tsx`
- [ ] 交易类型图标
- [ ] 交易金额
- [ ] 交易时间
- [ ] 交易说明
- [ ] 余额变动

## Phase 3: 个人中心首页 (优先级: P0)

### 3.1 页面创建
- [ ] 优化 `app/profile/page.tsx`
- [ ] 实现页面布局
- [ ] 添加标题

### 3.2 数据加载
- [ ] 从Store获取用户信息
- [ ] 加载统计数据
- [ ] 加载状态
- [ ] 错误处理

### 3.3 组件集成
- [ ] 集成UserInfo组件
- [ ] 集成AccountInfo组件
- [ ] 集成UserLevel组件
- [ ] 集成VerifyStatus组件
- [ ] 集成QuickLinks组件

### 3.4 权限验证
- [ ] 检查登录状态
- [ ] 未登录跳转登录页

## Phase 4: 编辑资料页面 (优先级: P0)

### 4.1 页面创建
- [ ] 创建 `app/profile/edit/page.tsx`
- [ ] 实现页面布局
- [ ] 集成面包屑导航

### 4.2 表单实现
- [ ] 头像上传（集成Upload组件）
- [ ] 昵称输入
- [ ] 手机号显示（禁用）
- [ ] 字数统计

### 4.3 表单验证
- [ ] 昵称长度验证（2-20字符）
- [ ] 实时验证
- [ ] 错误提示

### 4.4 提交处理
- [ ] 实现handleSubmit
- [ ] 调用userApi.updateProfile
- [ ] 更新Store
- [ ] 成功提示
- [ ] 返回个人中心

## Phase 5: 修改密码页面 (优先级: P0)

### 5.1 页面创建
- [ ] 创建 `app/profile/password/page.tsx`
- [ ] 实现页面布局
- [ ] 集成面包屑导航

### 5.2 表单实现
- [ ] 原密码输入
- [ ] 新密码输入
- [ ] 确认密码输入
- [ ] 密码可见性切换

### 5.3 密码强度提示
- [ ] 实时计算密码强度
- [ ] 显示强度指示器（弱/中/强）
- [ ] 显示密码规则提示

### 5.4 表单验证
- [ ] 原密码必填
- [ ] 新密码长度验证（6-20字符）
- [ ] 新密码格式验证（字母+数字）
- [ ] 确认密码一致性验证
- [ ] 实时验证
- [ ] 错误提示

### 5.5 提交处理
- [ ] 实现handleSubmit
- [ ] 调用userApi.changePassword
- [ ] 成功后清除登录状态
- [ ] 跳转登录页

## Phase 6: 实名认证页面 (优先级: P1)

### 6.1 页面创建
- [ ] 创建 `app/profile/verify/realname/page.tsx`
- [ ] 实现页面布局
- [ ] 集成面包屑导航

### 6.2 认证说明
- [ ] 认证用途说明
- [ ] 信息安全说明
- [ ] 认证流程说明

### 6.3 表单实现
- [ ] 真实姓名输入
- [ ] 身份证号输入
- [ ] 身份证正面上传
- [ ] 身份证反面上传

### 6.4 表单验证
- [ ] 姓名长度验证（2-20字符）
- [ ] 身份证号格式验证
- [ ] 照片必填验证
- [ ] 实时验证
- [ ] 错误提示

### 6.5 提交处理
- [ ] 实现handleSubmit
- [ ] 调用userApi.verifyRealName
- [ ] 成功提示
- [ ] 返回个人中心

### 6.6 认证状态处理
- [ ] 检查是否已认证
- [ ] 已认证显示认证信息
- [ ] 禁止重复认证

## Phase 7: 企业认证页面 (优先级: P1)

### 7.1 页面创建
- [ ] 创建 `app/profile/verify/company/page.tsx`
- [ ] 实现页面布局
- [ ] 集成面包屑导航

### 7.2 认证说明
- [ ] 认证用途说明
- [ ] 信息安全说明
- [ ] 认证流程说明

### 7.3 表单实现
- [ ] 企业名称输入
- [ ] 统一社会信用代码输入
- [ ] 法人姓名输入
- [ ] 营业执照照片上传

### 7.4 表单验证
- [ ] 企业名称必填
- [ ] 信用代码格式验证
- [ ] 法人姓名必填
- [ ] 营业执照必填
- [ ] 实时验证
- [ ] 错误提示

### 7.5 提交处理
- [ ] 实现handleSubmit
- [ ] 调用userApi.verifyCompany
- [ ] 成功提示
- [ ] 返回个人中心

### 7.6 认证状态处理
- [ ] 检查是否已认证
- [ ] 已认证显示认证信息
- [ ] 禁止重复认证

## Phase 8: 消费记录页面 (优先级: P1)

### 8.1 页面创建
- [ ] 创建 `app/profile/transactions/page.tsx`
- [ ] 实现页面布局
- [ ] 添加标题

### 8.2 筛选功能
- [ ] 类型筛选（全部/充值/消费/退款）
- [ ] 时间筛选（近7天/近30天/近3个月/自定义）
- [ ] 筛选条件状态管理

### 8.3 记录列表
- [ ] 集成TransactionList组件
- [ ] 调用API获取数据
- [ ] 加载状态
- [ ] 空状态

### 8.4 分页功能
- [ ] 集成Pagination组件
- [ ] 每页20条
- [ ] 页码切换

## Phase 9: 测试和优化 (优先级: P1)

### 9.1 功能测试
- [ ] 测试个人中心首页
- [ ] 测试编辑资料
- [ ] 测试修改密码
- [ ] 测试实名认证
- [ ] 测试企业认证
- [ ] 测试消费记录

### 9.2 边界测试
- [ ] 测试未登录访问
- [ ] 测试表单验证
- [ ] 测试重复认证
- [ ] 测试图片上传失败
- [ ] 测试网络错误

### 9.3 性能优化
- [ ] 图片懒加载
- [ ] 数据缓存
- [ ] 组件优化

### 9.4 用户体验优化
- [ ] 加载状态优化
- [ ] 错误提示优化
- [ ] 表单填写引导
- [ ] 移动端适配

## 依赖安装

```bash
cd frontend
npm install date-fns
```

## 验收标准

### Phase 1-2 验收（基础）
- [ ] 工具函数正常
- [ ] API调用正常
- [ ] 所有组件正常显示

### Phase 3 验收（个人中心首页）
- [ ] 页面正常显示
- [ ] 用户信息正确
- [ ] 统计数据正确
- [ ] 快捷入口正常

### Phase 4 验收（编辑资料）
- [ ] 表单正常显示
- [ ] 头像上传正常
- [ ] 昵称修改成功
- [ ] 验证规则正确

### Phase 5 验收（修改密码）
- [ ] 表单正常显示
- [ ] 密码强度提示正常
- [ ] 验证规则正确
- [ ] 修改成功后跳转登录

### Phase 6-7 验收（认证）
- [ ] 认证页面正常显示
- [ ] 表单验证正确
- [ ] 照片上传正常
- [ ] 认证提交成功
- [ ] 重复认证限制正确

### Phase 8 验收（消费记录）
- [ ] 记录列表正常显示
- [ ] 筛选功能正常
- [ ] 分页功能正常

### Phase 9 验收（优化）
- [ ] 所有功能测试通过
- [ ] 性能满足要求
- [ ] 用户体验良好

## 预计工时

- Phase 1: 2小时（工具和API）
- Phase 2: 4小时（基础组件）
- Phase 3: 2小时（个人中心首页）
- Phase 4: 2小时（编辑资料）
- Phase 5: 3小时（修改密码）
- Phase 6: 3小时（实名认证）
- Phase 7: 3小时（企业认证）
- Phase 8: 3小时（消费记录）
- Phase 9: 3小时（测试优化）

**总计: 25小时（约3个工作日）**

## 开发顺序建议

1. **第一天**：Phase 1-3（基础+首页）
2. **第二天**：Phase 4-6（编辑+密码+实名）
3. **第三天**：Phase 7-9（企业+记录+测试）
